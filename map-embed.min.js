!function(){const t="AIzaSyA_fUqhxvP_ZU57ns47VEgkyp3BqHRbxhA",e="map",o=51.5074,n=-.1278,a=10,r=2,i=18,l="https://cdn.jsdelivr.net/gh/hlabsdev1/cavandish@main/map.json",s=null,d=40,c=40,m="roadmap",p=!0,u=!0,g=!1;let w=null;const h="\n        .gm-ui-hover-effect {\n            height: 30px !important;\n            width: 48px;\n            top: 0px !important;\n            right: 0px !important;\n        }\n    ";function f(t,e="map",o=51.5074,n=-.1278,a=10,r=2,i=18,l="https://cdn.jsdelivr.net/gh/hlabsdev1/cavandish@main/map.json",s=null,d=40,c=40,m="roadmap",p=!0,u=!0,g=!1){const w=document.createElement("script");w.src=`https://maps.googleapis.com/maps/api/js?key=${t}&callback=renderMap`,w.async=!0,w.defer=!0,window.renderMap=function(){const t={lat:o,lng:n},w=document.getElementById(e);if(!w)return void console.error(`Map element with ID '${e}' not found`);let h=google.maps.MapTypeId.ROADMAP;switch(m.toLowerCase()){case"satellite":h=google.maps.MapTypeId.SATELLITE;break;case"hybrid":h=google.maps.MapTypeId.HYBRID;break;case"terrain":h=google.maps.MapTypeId.TERRAIN;break;default:h=google.maps.MapTypeId.ROADMAP}const f=new google.maps.Map(w,{zoom:a,center:t,mapTypeId:h,mapTypeControl:p,streetViewControl:p,zoomControl:p,fullscreenControl:p,scrollwheel:u,gestureHandling:u?"auto":"none",minZoom:r,maxZoom:i});return l&&fetch(l).then(t=>{if(!t.ok)throw new Error("Failed to fetch map styles");return t.json()}).then(t=>{t&&Array.isArray(t)?f.setOptions({styles:t}):console.warn("Invalid map styles format:",t)}).catch(t=>{console.error("Error loading map styles:",t)}),window.customGoogleMap=f,window.defaultMarkerIcon=s,window.markerIconWidth=d,window.markerIconHeight=c,k(),g&&f.addListener("click",function(t){const e=t.latLng.lat(),o=t.latLng.lng();window.open(`https://www.google.com/maps?q=${e},${o}`,"_blank")}),f},document.head.appendChild(w)}function k(){if(!window.customGoogleMap)return void console.error("Map not initialized yet");const t=document.getElementById(e);if(!t)return;document.querySelectorAll("[data-marker]").forEach(t=>{const e=parseFloat(t.getAttribute("data-lat")),o=parseFloat(t.getAttribute("data-lng")),n=t.getAttribute("data-title")||"",a=t.getAttribute("data-icon")||window.defaultMarkerIcon,r=parseInt(t.getAttribute("data-width")||window.markerIconWidth),i=parseInt(t.getAttribute("data-height")||window.markerIconHeight),l=t.getAttribute("data-url")||"",s=t.getAttribute("data-info")||"";isNaN(e)||isNaN(o)?console.error("Invalid marker coordinates:",t):b(e,o,n,a,r,i,l,s)});const o=t.attributes,n=/^data-marker-(\d+)$/,a=/^data-marker-(\d+)-icon$/,r=/^data-marker-(\d+)-width$/,i=/^data-marker-(\d+)-height$/,l=/^data-marker-(\d+)-url$/,s=/^data-marker-(\d+)-info$/,d={};for(let t=0;t<o.length;t++){const e=o[t];let c=e.name.match(n);if(c&&!e.name.endsWith("-icon")&&!e.name.endsWith("-width")&&!e.name.endsWith("-height")&&!e.name.endsWith("-url")&&!e.name.endsWith("-info")){const t=c[1],o=e.value,n=o.split(",").map(t=>t.trim());if(n.length>=2){const a=parseFloat(n[0]),r=parseFloat(n[1]),i=n[2]||"";isNaN(a)||isNaN(r)?console.error(`Invalid marker format for ${e.name}: ${o}`):(d[t]||(d[t]={}),d[t].lat=a,d[t].lng=r,d[t].title=i)}else console.error(`Invalid marker format for ${e.name}: ${o}`)}if(c=e.name.match(a),c){const t=c[1],o=e.value;d[t]||(d[t]={}),d[t].icon=o}if(c=e.name.match(r),c){const t=c[1],o=parseInt(e.value);d[t]||(d[t]={}),d[t].width=o}if(c=e.name.match(i),c){const t=c[1],o=parseInt(e.value);d[t]||(d[t]={}),d[t].height=o}if(c=e.name.match(l),c){const t=c[1],o=e.value;d[t]||(d[t]={}),d[t].url=o}if(c=e.name.match(s),c){const t=c[1],o=e.value;d[t]||(d[t]={}),d[t].info=o}}Object.keys(d).forEach(t=>{const e=d[t];e.lat&&e.lng&&b(e.lat,e.lng,e.title||"",e.icon||window.defaultMarkerIcon,e.width||window.markerIconWidth,e.height||window.markerIconHeight,e.url||"",e.info||"")})}function b(t,e,o="",n=null,a=40,r=40,i="",l=""){if(!window.customGoogleMap)return void console.error("Map not initialized yet. Call initCustomMap first.");const s={position:{lat:t,lng:e},map:window.customGoogleMap,title:o};if(n){const d=new Image,c=new google.maps.Marker(s);let m=null;return l&&(m=new google.maps.InfoWindow({content:l}),c.addListener("click",function(){w&&w.close(),m.open(window.customGoogleMap,c),w=m})),d.onload=function(){const s=a||d.width,m=r||d.height,p=s/2,u=m;c.setMap(null);const g=new google.maps.Marker({position:{lat:t,lng:e},map:window.customGoogleMap,title:o,icon:{url:n,scaledSize:new google.maps.Size(s,m),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(p,u)}});if(l){const t=new google.maps.InfoWindow({content:l});g.addListener("click",function(){w&&w.close(),t.open(window.customGoogleMap,g),w=t,i&&setTimeout(function(){window.open(i,"_blank")},300)})}else i&&g.addListener("click",function(){window.open(i,"_blank")});return g},d.src=n,i&&!l&&c.addListener("click",function(){window.open(i,"_blank")}),c}{const t=new google.maps.Marker(s);if(l){const e=new google.maps.InfoWindow({content:l});t.addListener("click",function(){w&&w.close(),e.open(window.customGoogleMap,t),w=e,i&&setTimeout(function(){window.open(i,"_blank")},300)})}else i&&t.addListener("click",function(){window.open(i,"_blank")});return t}}document.addEventListener("DOMContentLoaded",function(){const w=document.getElementById(e);if(!w)return void console.error(`Map element with ID '${e}' not found`);const k=parseFloat(w.getAttribute("data-lat")||o),b=parseFloat(w.getAttribute("data-lng")||n),I=parseInt(w.getAttribute("data-zoom")||a),A=parseInt(w.getAttribute("data-min-zoom")||r),M=parseInt(w.getAttribute("data-max-zoom")||i),y=w.getAttribute("data-styles-url")||l,v=w.getAttribute("data-marker-icon")||s,L=parseInt(w.getAttribute("data-marker-width")||d),$=parseInt(w.getAttribute("data-marker-height")||c),E=w.getAttribute("data-api-key")||t,C=(w.getAttribute("data-map-type")||m).toLowerCase(),T=w.hasAttribute("data-show-controls")?"false"!==w.getAttribute("data-show-controls"):p,z=w.hasAttribute("data-scroll-zoom")?"false"!==w.getAttribute("data-scroll-zoom"):u,W=w.hasAttribute("data-open-google-maps")?"true"===w.getAttribute("data-open-google-maps"):g;!function(){const t=document.createElement("style");t.type="text/css",t.appendChild(document.createTextNode(h)),document.head.appendChild(t)}(),f(E,e,k,b,I,A,M,y,v,L,$,C,T,z,W)}),window.initCustomMap=f,window.addMarker=b,window.findAndAddMarkers=k}();